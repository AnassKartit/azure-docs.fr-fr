---
title: Guide de référence des règles d’évaluation des vulnérabilités SQL
description: Liste des titres et descriptions de règles pour SQL Server, Azure SQL Database, Azure SQL Managed Instance et Azure Synapse Analytics
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.topic: reference
author: davidtrigano
ms.author: datrigan
ms.reviewer: vanto
ms.date: 05/06/2021
ms.openlocfilehash: b18784bad5a47d699f1b05ec3d252c13459af308
ms.sourcegitcommit: 89c4843ec85d1baea248e81724781d55bed86417
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/06/2021
ms.locfileid: "108794067"
---
# <a name="sql-vulnerability-assessment-rules-reference-guide"></a>Guide de référence des règles d’évaluation des vulnérabilités SQL
[!INCLUDE[appliesto-sqldb-sqlmi-asa](../includes/appliesto-sqldb-sqlmi-asa.md)]:::image type="icon" source="../media/applies-to/yes.png" border="false"::: SQL Server (toutes les versions prises en charge)

Cet article répertorie l’ensemble de règles intégrées utilisées pour marquer les failles de sécurité et mettre en évidence les écarts par rapport aux meilleures pratiques, notamment les erreurs de configuration, les autorisations excessives et les données sensibles non protégées. Les règles sont basées sur les bonnes pratiques de Microsoft et axées sur les problèmes de sécurité qui présentent des risques majeurs pour votre base de données et ses précieuses données. Elles couvrent les problèmes au niveau de la base de données ainsi que les problèmes de sécurité au niveau du serveur, comme les paramètres de pare-feu serveur et les autorisations au niveau du serveur. Elles représentent également la plupart des exigences des différentes instances réglementaires, visant au respect de leurs normes de conformité.

Les règles affichées dans vos analyses de base de données dépendent de la version de SQL et de la plateforme analysée. 

Pour savoir comment implémenter Évaluation des vulnérabilités dans Azure, consultez [Implémenter Évaluation des vulnérabilités](./sql-vulnerability-assessment.md#configure-vulnerability-assessment).

Pour obtenir la liste des modifications apportées à ces règles, consultez [Journal des modifications des règles d’évaluation des vulnérabilités SQL](sql-database-vulnerability-assessment-rules-changelog.md).

## <a name="rule-categories"></a>Catégories de règles

Les règles d’évaluation des vulnérabilités SQL comportent cinq catégories, qui sont répertoriées dans les sections suivantes :

- [Authentification et autorisation](#authentication-and-authorization)
- [Audit et journalisation](#auditing-and-logging)
- [Protection des données](#data-protection)
- [Mises à jour et correctifs d’installation](#installation-updates-and-patches)
- [Réduction de la surface d’exposition](#surface-area-reduction)

<sup>1</sup> **SQL Server 2012+** désigne toutes les versions de SQL Server 2012 et supérieures.

<sup>2</sup> **SQL Server 2017+** désigne toutes les versions de SQL Server 2017 et supérieures.

<sup>3</sup> **SQL Server 2016+** désigne toutes les versions de SQL Server 2016 et supérieures.

## <a name="authentication-and-authorization"></a>Authentification et autorisation

|Identificateur de la règle  |Titre de la règle   |Gravité de la règle  |Description de la règle  |Plateforme  |
|---------|---------|---------|---------|---------|
| VA1017     |Les autorisations d’exécution sur xp_cmdshell de tous les utilisateurs (sauf dbo) doivent être révoquées          |Importante         |La procédure stockée étendue xp_cmdshell génère un interpréteur de commandes Windows, en transmettant une chaîne pour exécution. Cette règle vérifie qu’aucun utilisateur (autre que les utilisateurs dotés de l’autorisation CONTROL SERVER, par exemple les membres du rôle serveur administrateur système) n’a l’autorisation d’exécuter la procédure stockée étendue xp_cmdshell.         |<nobr>SQL Server 2012+<sup>1</sup><nobr/>         |
|VA1020     |L’utilisateur de base de données GUEST ne doit appartenir à aucun rôle          |Élevé         |L’utilisateur invité autorise l’accès à une base de données pour toutes les connexions qui ne sont pas mappées à un utilisateur de base de données spécifique. Cette règle vérifie qu’aucun rôle de base de données n’est attribué à l’utilisateur invité.         |<nobr>SQL Server 2012+<nobr/><br/><br/>SQL Database                  |
|VA1042     |Le chaînage des propriétés des bases de données doit être désactivé pour toutes les bases de données à l’exception de `master`, `msdb` et `tempdb`          |Importante         |Le chaînage des propriétés des bases de données croisées est une extension du chaînage des propriétés, à la différence qu’il franchit les limites des bases de données. Cette règle vérifie que cette option est désactivée pour toutes les bases de données à l’exception de `master`, `msdb` et `tempdb` . Pour `master`, `msdb` et `tempdb`, le chaînage des propriétés entre bases de données est activé par défaut.        |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1043     |Le GUEST principal ne doit pas avoir accès aux bases de données utilisateur          |Moyenne         |L’utilisateur invité autorise l’accès à une base de données pour toutes les connexions qui ne sont pas mappées à un utilisateur de base de données spécifique. Cette règle vérifie que l’utilisateur invité ne peut pas se connecter à une base de données.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL        |
|VA1046     |CHECK_POLICY doit être activé pour toutes les connexions SQL          |Faible         |L’option CHECK_POLICY permet de vérifier les connexions SQL par rapport à la stratégie de domaine. Cette règle vérifie que l’option CHECK_POLICY est activée pour toutes les connexions SQL.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1047     |La vérification de l’expiration du mot de passe doit être activée pour toutes les connexions SQL          |Faible         |Les stratégies d'expiration des mots de passe servent à gérer la durée de vie d'un mot de passe. Lorsque SQL Server applique la stratégie d’expiration des mots de passe, les utilisateurs sont invités à modifier leur ancien mot de passe, et les comptes dont le mot de passe est arrivé à expiration sont désactivés. Cette règle vérifie que la stratégie d’expiration des mots de passe est activée pour toutes les connexions SQL.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1048     |Les principaux de base de données ne doivent pas être mappés au compte `sa`          |Élevé         |Un principal de base de données mappé au compte `sa` peut être exploité par une personne malveillante pour élever les autorisations à `sysadmin`         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1052     |Supprimer BUILTIN\Administrateurs comme connexion au serveur          |Faible         |Le groupe BUILTIN\Administrateurs contient le groupe Administrateurs locaux Windows. Dans les versions antérieures de Microsoft SQL Server, ce groupe dispose des droits d’administrateur par défaut. Cette règle vérifie que ce groupe est supprimé de SQL Server.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1053     |Le compte ayant le nom par défaut `sa` doit être renommé ou désactivé          |Faible         |`sa` est un compte connu avec l’ID de principal 1. Cette règle vérifie que le compte `sa` est renommé ou désactivé.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1054     |Des autorisations excessives ne doivent pas être accordées au rôle PUBLIC sur des objets ou des colonnes          |Faible         |Chaque connexion SQL Server appartient au rôle serveur public. Lorsqu’un principal de serveur ne s’est pas vu accorder ou refuser des autorisations spécifiques sur un objet sécurisable, l’utilisateur hérite des autorisations accordées au rôle public sur cet objet. Cette règle affiche une liste de tous les objets ou colonnes sécurisables accessibles à tous les utilisateurs par le biais du rôle PUBLIC.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1058     |La connexion `sa` doit être désactivée          |Élevé         |`sa` est un compte connu avec l’ID de principal 1. Cette règle vérifie que le compte `sa` est désactivé.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1059     |xp_cmdshell doit être désactivé          |Élevé         |xp_cmdshell génère une interface de commande Windows et lui transmet une chaîne à traiter. Cette règle vérifie que xp_cmdshell est désactivé.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1067     |L’option Database Mail XPs doit être désactivée lorsqu’elle n’est pas utilisée          |Medium         |Cette règle vérifie que la fonctionnalité Database Mail est désactivée quand aucun profil de messagerie de base de données n’est configuré. La fonctionnalité Database Mail peut être utilisée pour envoyer des e-mails à partir du Moteur de base de données SQL Server. Elle est désactivée par défaut. Si vous ne l’utilisez pas, il est recommandé de la désactiver pour réduire la surface d’exposition.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1068     |Les autorisations de serveur ne doivent pas être accordées directement aux principaux          |Faible         |Les autorisations de niveau serveur sont associées à un objet de niveau serveur pour déterminer quels sont les utilisateurs qui peuvent accéder à l’objet. Cette règle vérifie qu’aucune autorisation de niveau serveur n’est accordée directement aux connexions.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1070     |Les utilisateurs de base de données ne doivent pas avoir le même nom qu’un compte de connexion de serveur          |Faible         |Des utilisateurs de base de données peuvent avoir le même nom qu’un compte de connexion de serveur. Cette règle vérifie l’absence de tels utilisateurs.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1072     |Le mode d’authentification doit être l’authentification Windows          |Moyenne         |Deux modes d’authentification sont disponibles : Mode d'authentification Windows et mode mixte. Le mode mixte signifie que SQL Server admet l’authentification Windows et l’authentification SQL Server. Cette règle vérifie que le mode d’authentification est défini sur Authentification Windows.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1094     |Les autorisations de base de données ne doivent pas être accordées directement aux principaux          |Faible         |Les autorisations sont des règles associées à un objet sécurisable pour déterminer quels sont les utilisateurs qui peuvent accéder à cet objet. Cette règle vérifie qu’aucune autorisation de base de données n’est accordée directement aux utilisateurs.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1095     |Des autorisations excessives ne doivent pas être accordées au rôle PUBLIC          |Moyenne         |Chaque connexion SQL Server appartient au rôle serveur public. Lorsqu’un principal de serveur ne s’est pas vu accorder ou refuser des autorisations spécifiques sur un objet sécurisable, l’utilisateur hérite des autorisations accordées au rôle public sur cet objet. Une liste de toutes les autorisations accordées au rôle PUBLIC s’affiche.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1096     |Le GUEST principal ne doit pas recevoir d’autorisations dans la base de données          |Faible         |Chaque base de données inclut un utilisateur appelé GUEST. Les autorisations accordées à l’utilisateur GUEST sont héritées par les utilisateurs qui ont accès à la base de données mais qui n’ont pas de compte d’utilisateur dans la base de données. Cette règle vérifie que toutes les autorisations ont été révoquées pour l’utilisateur GUEST.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1097     |Le GUEST principal ne doit pas recevoir d’autorisations sur les objets ou les colonnes          |Faible         |Chaque base de données inclut un utilisateur appelé GUEST. Les autorisations accordées à l’utilisateur GUEST sont héritées par les utilisateurs qui ont accès à la base de données mais qui n’ont pas de compte d’utilisateur dans la base de données. Cette règle vérifie que toutes les autorisations ont été révoquées pour l’utilisateur GUEST.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1099     |L’utilisateur GUEST ne doit pas recevoir d’autorisations sur des éléments sécurisables de base de données          |Faible         |Chaque base de données inclut un utilisateur appelé GUEST. Les autorisations accordées à l’utilisateur GUEST sont héritées par les utilisateurs qui ont accès à la base de données mais qui n’ont pas de compte d’utilisateur dans la base de données. Cette règle vérifie que toutes les autorisations ont été révoquées pour l’utilisateur GUEST.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1246     |Les rôles d’application ne doivent pas être utilisés          |Faible         |Un rôle d’application est un principal de base de données qui permet à une application de s’exécuter avec ses propres autorisations de type utilisateur. Les rôles d’application permettent que seuls les utilisateurs qui se connectent via une application particulière puissent accéder à des données spécifiques. Les rôles d’application sont basés sur un mot de passe (que les applications codent généralement en dur) et non sur des autorisations, ce qui expose la base de données à un emprunt d’identité du rôle d’application par déchiffrement de mot de passe. Cette règle vérifie qu’aucun rôle d’application n’est défini dans la base de données.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database         |
|VA1248     |Les rôles de base de données définis par l’utilisateur ne doivent pas être membres de rôles fixes          |Moyenne         |Pour gérer facilement les autorisations dans vos bases de données, SQL Server fournit plusieurs rôles, qui sont des principaux de sécurité regroupant d’autres principaux. Les rôles sont comme des groupes dans le système d’exploitation Microsoft Windows. Des comptes de base de données et d’autres rôles SQL Server peuvent être ajoutés aux rôles au niveau de la base de données. Chaque membre d’un rôle de base de données fixe peut ajouter des utilisateurs à ce rôle. Cette règle vérifie qu’aucun rôle défini par l’utilisateur n’est membre d’un rôle fixe.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1267     |Les utilisateurs contenus doivent utiliser l’authentification Windows          |Moyenne         |Les utilisateurs contenus sont des utilisateurs qui existent au sein de la base de données et qui ne nécessitent pas de mappage de connexion. Cette règle vérifie que les utilisateurs contenus utilisent l’authentification Windows.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1280     |Les autorisations de serveur accordées au public doivent être réduites au minimum          |Moyenne         |Chaque connexion SQL Server appartient au rôle serveur public. Lorsqu’un principal de serveur ne s’est pas vu accorder ou refuser des autorisations spécifiques sur un objet sécurisable, l’utilisateur hérite des autorisations accordées au rôle public sur cet objet. Cette règle vérifie que les autorisations de serveur accordées au public sont réduites au minimum.          |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1282     |Les rôles orphelins doivent être supprimés          |Faible         |Les rôles orphelins sont des rôles définis par l’utilisateur qui n’ont pas de membres. Supprimez les rôles orphelins, car ils sont inutiles sur le système. Cette règle vérifie qu’il n’y a pas de rôle orphelin.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2020     |Un ensemble minimal de principaux doit recevoir des autorisations ALTER ou ALTER ANY USER limitées à la base de données          |Élevé         |Chaque élément sécurisable de SQL Server dispose d’autorisations associées qui peuvent être accordées aux principaux. Les autorisations peuvent être étendues au niveau du serveur (pour les connexions et les rôles de serveur) ou au niveau de la base de données (pour les utilisateurs de base de données et les rôles de base de données). Ces règles vérifient que seul un ensemble minimal de principaux est doté d’autorisations ALTER ou ALTER ANY USER limitées à la base de données.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2033     |Un ensemble minimal de principaux doit recevoir des autorisations EXECUTE limitées à la base de données sur les objets et les colonnes          |Faible         |Cette règle vérifie quels principaux disposent de l’autorisation EXECUTE sur les objets et les colonnes pour faire en sorte que cette autorisation ne soit accordée qu’à un ensemble minimal de principaux. Chaque élément sécurisable de SQL Server dispose d’autorisations associées qui peuvent être accordées aux principaux. Les autorisations peuvent être étendues au niveau du serveur (affectées aux connexions et aux rôles serveur) ou de la base de données (affectées aux utilisateurs de base de données, aux rôles de base de données et aux rôles d’application). L’autorisation EXECUTE s’applique aux procédures stockées et aux fonctions scalaires, qui peuvent être utilisées dans les colonnes calculées.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2103     |Les autorisations d’exécution inutiles sur les procédures stockées étendues doivent être révoquées          |Moyenne         |Les procédures stockées étendues sont des bibliothèques de liens dynamiques (DLL) qu’une instance SQL Server peut charger et exécuter dynamiquement. SQL Server est empaqueté avec de nombreuses procédures stockées étendues qui permettent l’interaction avec les DLL système. Cette règle vérifie que les autorisations d’exécution inutiles sur les procédures stockées étendues ont été révoquées.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA2107     |Un ensemble minimal de principaux doivent être membres de rôles de base de données master Azure SQL Database fixes          |Élevé         |SQL Database fournit deux rôles d’administration restreints dans la base de données master. Vous pouvez y ajouter des comptes d’utilisateurs qui accordent des autorisations de création de bases de données ou de gestion des connexions. Cette règle vérifie qu’un ensemble minimal de principaux sont membres de ces rôles administratifs.         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2108     |Un ensemble minimal de principaux doivent être membres de rôles de base de données fixes à impact élevé          |Élevé         |SQL Server fournit des rôles pour faciliter la gestion des autorisations. Les rôles sont des principaux de sécurité qui regroupent d’autres principaux. Les autorisations des rôles au niveau de la base de données ont une portée à l’échelle de la base de données. Cette règle vérifie qu’un ensemble minimal de principaux sont membres de ces rôles de base de données fixes.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2109     |Un ensemble minimal de principaux doivent être membres de rôles de base de données fixes à impact faible          |Faible         |SQL Server fournit des rôles pour faciliter la gestion des autorisations. Les rôles sont des principaux de sécurité qui regroupent d’autres principaux. Les autorisations des rôles au niveau de la base de données ont une portée à l’échelle de la base de données. Cette règle vérifie qu’un ensemble minimal de principaux sont membres de ces rôles de base de données fixes.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2110     |Les autorisations d’exécution pour accéder au registre doivent être révoquées          |Élevé         |Les procédures stockées étendues du registre permettent à Microsoft SQL Server de lire, écrire et énumérer des valeurs et des clés dans le registre. Elles sont utilisées par Enterprise Manager pour configurer le serveur. Cette règle vérifie que les autorisations pour exécuter des procédures stockées étendues du registre ont été révoquées pour tous les utilisateurs (autres que dbo).         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA2113     |Les autorisations DTS ne doivent être accordées qu’aux rôles SSIS          |Moyenne         |DTS (Data Transformation Services) est un ensemble d’objets et d’utilitaires qui permet l’automatisation des opérations d’extraction, de transformation et de chargement sur ou à partir d’une base de données. Les objets sont les packages DTS et leurs composants, et les utilitaires sont appelés outils DTS. Cette règle vérifie que seuls les rôles SSIS disposent de l’autorisation d’utiliser les procédures stockées système DTS et que les autorisations permettant au rôle PUBLIC de se servir de ces procédures ont été révoquées.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA2114     |Un ensemble minimal de principaux doivent être membres de rôles de serveur fixes à impact élevé          |Élevé         |SQL Server fournit des rôles pour faciliter la gestion des autorisations. Les rôles sont des principaux de sécurité qui regroupent d’autres principaux. Les autorisations des rôles serveur ont une portée à l’échelle du serveur. Cette règle vérifie qu’un ensemble minimal de principaux sont membres de ces rôles de serveur fixes.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA2129     |Les modifications des modules signés doivent être autorisées          |Élevé         |Vous pouvez signer une procédure stockée, une fonction ou un déclenchement avec un certificat ou une clé asymétrique. Cela est très utile dans les scénarios où les autorisations ne peuvent pas être héritées par chaînage des propriétés ou lorsque la chaîne de propriétés est rompue, par exemple SQL dynamique. Cette règle recherche les modifications apportées aux modules signés, qui peuvent indiquer une utilisation malveillante.         |<nobr>SQL Server 2012+<nobr/><br/><br/>SQL Database<br/><br/>Instance managée SQL         |
|VA2130     |Suivre tous les utilisateurs ayant accès à la base de données          |Faible         |Ce contrôle suit tous les utilisateurs ayant accès à une base de données. Vérifiez que ces utilisateurs sont autorisés en fonction de leur rôle actuel dans l’organisation.         |<nobr>Base de données SQL<nobr/><br/><br/>Azure Synapse         |

## <a name="auditing-and-logging"></a>Audit et journalisation

|Identificateur de la règle  |Titre de la règle  |Gravité de la règle  |Description de la règle  |Plateforme  |
|---------|---------|---------|---------|---------|
|VA1045     |La trace par défaut doit être activée          |Moyenne         |La trace par défaut aide les administrateurs de bases de données à résoudre les problèmes en leur fournissant les données de journal qui leur permettent de les diagnostiquer dès leur première occurrence. Cette règle vérifie que la trace par défaut est activée.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1091     |L’audit des tentatives de connexion réussies et ayant échoué (trace par défaut) doit être activé lorsque « Audit des connexions » est configuré pour suivre les connexions          |Faible         |La configuration de l’audit des connexions SQL Server permet aux administrateurs de suivre les connexions des utilisateurs aux instances SQL Server. Si l’utilisateur choisit de recourir à l’option « Audit des connexions » pour suivre les connexions des utilisateurs aux instances SQL Server, il est important de l’activer pour les tentatives de connexion réussies et pour celles ayant échoué.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1093     |Le nombre maximal de journaux d’erreurs doit être supérieur ou égal à 12          |Faible         |Chaque journal d’erreurs SQL Server contient toutes les informations relatives aux échecs/erreurs survenus depuis le dernier redémarrage de SQL Server ou depuis la dernière fois que vous avez recyclé les journaux d’erreurs. Cette règle vérifie que le nombre maximal de journaux d’erreurs est 12 ou plus.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1258     |Les propriétaires de base de données sont conformes aux attentes          |Élevé         |Les propriétaires de base de données peuvent effectuer toutes les activités de configuration et de maintenance sur la base de données et peuvent également supprimer les bases de données dans SQL Server. Le suivi des propriétaires de bases de données est essentiel pour éviter d’avoir des autorisations excessives pour certains principaux. Créez une base de référence qui définit les propriétaires de base de données attendus pour la base de données. Cette règle vérifie si les propriétaires de base de données sont tels que définis dans la base de référence.         |<nobr>SQL Server 2016+<sup>3</sup><nobr/><br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1264     |L’audit des tentatives de connexion réussies et ayant échoué doit être activé          |Faible         |La configuration de l’audit de SQL Server permet aux administrateurs de suivre les connexions des utilisateurs aux instances SQL Server dont ils sont responsables. Cette règle vérifie que l’audit est activé pour les tentatives de connexion réussies et ayant échoué.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1265     |L’audit des tentatives de connexion réussies et ayant échoué pour l’authentification à la base de données autonome doit être activé          |Moyenne         |La configuration de l’audit de SQL Server permet aux administrateurs de suivre les connexions des utilisateurs aux instances SQL Server dont ils sont responsables. Cette règle vérifie que l’audit est activé pour les tentatives réussies et ayant échoué pour l’authentification à la base de données autonome.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1281     |Toutes les appartenances pour les rôles définis par l’utilisateur doivent être prévues          |Moyenne         |Les rôles définis par l’utilisateur sont des principaux de sécurité définis par l’utilisateur pour regrouper les principaux afin de faciliter la gestion des autorisations. La surveillance de ces rôles est importante pour éviter d’avoir des autorisations excessives. Créez une base de référence qui définit l’appartenance attendue pour chaque rôle défini par l’utilisateur. Cette règle vérifie si toutes les appartenances pour les rôles définis par l’utilisateur sont conformes à celles définies dans la base de référence.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1283     |Il doit y avoir au moins un audit actif dans le système          |Faible         |L’audit d’une instance du moteur de base de données SQL Server ou d’une base de données individuelle implique le suivi et la journalisation des événements qui se produisent sur le moteur de base de données. L’objet Audit SQL Server recueille une seule instance des actions et des groupes d’actions au niveau du serveur ou de la base de données à surveiller. Cette règle vérifie qu’il existe au moins un audit actif dans le système.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA2061     |L’audit doit être activé au niveau du serveur          |Élevé         |L’audit Azure SQL Database suit les événements de base de données et les écrit dans un journal d’audit dans votre compte de stockage Azure. L’audit peut vous aider à comprendre l’activité de la base de données et à découvrir des discordances et anomalies susceptibles d’indiquer des problèmes pour l’entreprise ou des violations de la sécurité, ainsi qu’à respecter une conformité réglementaire. Pour plus d’informations, consultez [Audit Azure SQL](./auditing-overview.md). Cette règle vérifie que l’audit est activé.         |<nobr/>SQL Database<br/><br/>Azure Synapse          |

## <a name="data-protection"></a>Protection des données

|Identificateur de la règle  |Titre de la règle  |Gravité de la règle  |Description de la règle  |Plateforme  |
|---------|---------|---------|---------|---------|
|VA1098     |Tout point de terminaison SSB ou de mise en miroir existant doit exiger une connexion AES          |Élevé         |Les points de terminaison Service Broker et de mise en miroir prennent en charge différents algorithmes de chiffrement, y compris l’absence de chiffrement. Cette règle vérifie que tous les points de terminaison existants exigent le chiffrement AES.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1219     |Le chiffrement transparent des données doit être activé          |Medium         |Le chiffrement TDE (Transparent Data Encryption) contribue à protéger les fichiers de base de données contre la divulgation d’informations en effectuant un chiffrement et un déchiffrement en temps réel de la base de données, des sauvegardes associées et des fichiers journaux de transactions au repos, sans qu’il soit nécessaire de modifier l’application. Cette règle vérifie que le TDE est activé sur la base de données.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1220     |La communication de base de données à l’aide de TDS doit être protégée via TLS          |Élevé         |Microsoft SQL Server peut utiliser les protocoles SSL ou TLS pour chiffrer des données transmises sur un réseau entre une instance de SQL Server et une application cliente. Cette règle vérifie que toutes les connexions à SQL Server sont chiffrées via TLS.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1221     |Les clés symétriques de chiffrement de base de données doivent utiliser l’algorithme AES          |Élevé         |SQL Server utilise des clés de chiffrement pour mieux sécuriser les données, les informations d’identification et les informations de connexion qui sont stockées dans une base de données du serveur. SQL Server a deux types de clés : symétriques et asymétriques. Cette règle vérifie que les clés symétriques de chiffrement de base de données utilisent l’algorithme AES.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1222     |Les clés de chiffrement au niveau des cellules doivent utiliser l’algorithme AES          |Élevé         |Le chiffrement au niveau des cellules vous permet de chiffrer vos données à l’aide de clés symétriques et asymétriques. Cette règle vérifie que les clés symétriques de chiffrement au niveau des cellules utilisent l’algorithme AES.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1223     |Les clés de certificat doivent utiliser au moins 2 048 bits          |Élevé         |Les clés de certificat sont utilisées dans RSA et d’autres algorithmes de chiffrement pour protéger les données. Ces clés doivent avoir une longueur suffisante pour sécuriser les données de l’utilisateur. Cette règle vérifie que la longueur de la clé est d’au moins 2 048 bits pour tous les certificats.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1224     |La longueur des clés asymétriques doit être d’au moins 2 048 bits          |Élevé         |Les clés asymétriques de base de données sont utilisées dans de nombreux algorithmes de chiffrement. Elles doivent être suffisamment longues pour sécuriser les données chiffrées. Cette règle vérifie que toutes les clés asymétriques stockées dans la base de données ont une longueur minimale de 2 048 bits         |<nobr>SQL Server 2012<nobr/><br/><br/><nobr>SQL Server 2014<nobr/><br/><br/>SQL Database         |
|VA1279     |L’option Forcer le chiffrement doit être activée pour TDS          |Élevé         |Lorsque l’option Forcer le chiffrement pour le moteur de base de données est activé, toutes les communications entre client et serveur sont chiffrées, que l’option « Chiffrer la connexion » (par exemple depuis SSMS) soit activée ou non. Cette règle vérifie que l’option Forcer le chiffrement est activée.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1288     |Les colonnes de données sensibles doivent être classifiées          |Medium         |Cette règle vérifie si la base de données analysée contient des données potentiellement sensibles qui n’ont pas été classées.         |<nobr/>SQL Database         |
|VA2060     |La Détection des menaces SQL doit être activée au niveau du serveur          |Moyenne         |La Détection des menaces SQL fournit une couche de sécurité qui détecte les vulnérabilités potentielles et l’activité anormale dans les bases de données, par exemple les attaques par injection de code SQL et les modèles de comportement inhabituel. Lorsqu’une menace potentielle est détectée, la Détection des menaces envoie en temps réel une alerte actionnable par e-mail et dans Azure Security Center, dans laquelle sont clairement expliquées les étapes d’investigation et de correction pour la menace spécifique. Pour en savoir plus, consultez [Configurer la détection des menaces](./threat-detection-configure.md). Ce contrôle vérifie que la Détection des menaces SQL est activée         |<nobr/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |

## <a name="installation-updates-and-patches"></a>Mises à jour et correctifs d’installation

|Identificateur de la règle  |Titre de la règle  |Gravité de la règle  |Description de la règle  |Plateforme  |
|---------|---------|---------|---------|---------|
| VA1018     |Les dernières mises à jour doivent être installées          |Élevé         |Microsoft publie régulièrement des mises à jour cumulatives pour chaque version de SQL Server. Cette règle vérifie si la dernière mise à jour cumulative a été installée pour cette version particulière de SQL Server, en transmettant une chaîne pour exécution. Cette règle vérifie que tous les utilisateurs (sauf dbo) ne sont pas autorisés à exécuter la procédure stockée étendue xp_cmdshell. |<nobr>SQL Server 2005<nobr/><br/><br/><nobr>SQL Server 2008<nobr/><br/><br/><nobr>SQL Server 2008<nobr/><br/><br/><nobr>SQL Server 2012<nobr/><br/><br/><nobr>SQL Server 2014<nobr/><br/><br/><nobr>SQL Server 2016<nobr/><br/><br/>SQL Server 2017<br/>|
|VA2128     |Vulnerability Assessment n’est pas pris en charge pour les versions de SQL Server antérieures à SQL Server 2012          |Élevé         |Pour exécuter une analyse Vulnerability Assessment sur votre SQL Server, le serveur doit être mis à niveau vers SQL Server 2012 ou une version ultérieure ; les versions SQL Server 2008 R2 et antérieures ne sont plus prises en charge par Microsoft. Pour plus d'informations, consultez <https://www.microsoft.com/cloud-platform/windows-sql-server-2008>         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |

## <a name="surface-area-reduction"></a>Réduction de la surface d’exposition

|Identificateur de la règle  |Titre de la règle  |Gravité de la règle  |Description de la règle  |Plateforme  |
|---------|---------|---------|---------|---------|
|VA1022     |Les requêtes distribuées ad hoc doivent être désactivées          |Moyenne         |Les requêtes distribuées ad hoc utilisent les fonctions `OPENROWSET` et `OPENDATASOURCE` pour la connexion aux sources de données distantes OLE DB. Cette règle vérifie que les requêtes distribuées ad hoc ont été désactivées.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1023     |CLR doit être désactivé          |Élevé         |CLR permet l’hébergement et l’exécution du code managé dans l’environnement Microsoft SQL Server. Cette règle vérifie que CLR est désactivé.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1026     |CLR doit être désactivé          |Moyenne         |CLR permet l’hébergement et l’exécution du code managé dans l’environnement Microsoft SQL Server. La sécurité stricte de CLR traite les assemblies SAFE et EXTERNAL_ACCESS comme s’ils étaient UNSAFE et exige que tous les assemblies soient signés par un certificat ou une clé asymétrique avec une connexion correspondante dotée de l’autorisation UNSAFE ASSEMBLY dans la base de données master. Cette règle vérifie que CLR est désactivé.         |<nobr>SQL Server 2017+<sup>2</sup><nobr/><br/><br/>Instance managée SQL         |
|VA1027     |Les assemblies approuvés non suivis doivent être supprimés          |Élevé         |Les assemblies marqués comme UNSAFE doivent être signés par un certificat ou une clé asymétrique avec une connexion correspondante dotée de l’autorisation UNSAFE ASSEMBLY dans la base de données master. Les assemblies approuvés peuvent ignorer cette exigence.          |<nobr>SQL Server 2017+<nobr/><br/><br/>Instance managée SQL         |
|VA1044     |Les connexions administrateur distant doivent être désactivées, sauf exigence spécifique          |Medium         |Cette règle vérifie que les connexions administrateur dédiées distantes sont désactivées si elles ne sont pas utilisées pour le clustering afin de réduire la surface d’exposition aux attaques. SQL Server propose une connexion administrateur dédiée (DAC). Cette connexion DAC permet à un administrateur d’accéder à un serveur en cours d’exécution pour exécuter des fonctions de diagnostic ou des instructions Transact-SQL, ou de résoudre des problèmes sur le serveur. Elle devient une cible intéressante à attaquer lorsqu’elle est activée à distance.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1051     |AUTO_CLOSE doit être désactivé sur toutes les bases de données          |Medium         |L’option AUTO_CLOSE spécifie si la base de données se ferme proprement et libère les ressources lorsque le dernier utilisateur se déconnecte. Indépendamment de ses avantages, elle peut provoquer un déni de service par une ouverture et une fermeture agressives de la base de données. Il est donc important de désactiver cette fonctionnalité. Cette règle vérifie qu’elle est désactivée sur la base de données actuelle.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1066     |Les points de terminaison de service inutilisés doivent être supprimés          |Faible         |Service Broker fournit des files d’attente et une messagerie fiable pour SQL Server. Service Broker est tout aussi utile aux applications qui exploitent une instance SQL Server unique qu’aux applications qui répartissent le travail entre plusieurs instances. Les points de terminaison Service Broker fournissent des options pour la sécurité du transport et le transfert de messages. Cette règle énumère tous les points de terminaison Service Broker. Supprimez ceux qui ne sont pas utilisés.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1071     |L’option « Rechercher les procédures stockées de démarrage » doit être désactivée          |Moyenne         |Lorsque l’option « Rechercher les procédures stockées de démarrage » est activée, SQL Server recherche et exécute toutes les procédures stockées exécutées automatiquement définies sur le serveur. Si l’option est activée, SQL Server recherche et exécute toutes les procédures stockées exécutées automatiquement définies sur le serveur. Cette règle vérifie que cette option est désactivée.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1092     |L’instance SQL Server ne doit pas être publiée par le service SQL Server Browser          |Faible         |SQL Server utilise le service SQL Server Browser pour énumérer les instances du moteur de base de données installées sur l’ordinateur. Cela permet aux applications clientes de rechercher un serveur et aide les clients à effectuer la distinction entre plusieurs instances du moteur de base de données sur le même ordinateur. Cette règle vérifie que l’instance SQL est masquée.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1102     |Le bit TRUSTWORTHY doit être désactivé sur toutes les bases de données à l’exception de MSDB          |Élevé         |La propriété de base de données TRUSTWORTHY permet d’indiquer si l’instance de SQL Server approuve la base de données et son contenu. Si cette option est activée, les modules de base de données (tels que les fonctions définies par l’utilisateur ou les procédures stockées) utilisant un contexte d’emprunt d’identité ont accès à des ressources extérieures à la base de données. Cette règle vérifie que le bit TRUSTWORTHY est désactivé sur toutes les bases de données à l’exception de MSDB.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1143     |L’utilisateur « dbo » ne doit pas être utilisé pour le fonctionnement normal du service          |Moyenne         |Le « dbo », ou propriétaire de base de données,est un compte d’utilisateur doté des autorisations implicites nécessaires pour effectuer toutes les activités dans la base de données. Les membres du rôle serveur fixe sysadmin sont automatiquement mappés à dbo. Cette règle vérifie que dbo n’est pas le seul compte autorisé à accéder à cette base de données. Notez que sur une nouvelle base de données propre, cette règle échoue jusqu’à ce que des rôles supplémentaires soient créés.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1144     |La base de données model ne doit être accessible que par « dbo »          |Moyenne         |La base de données model fait office de modèle pour toutes les bases de données créées sur une instance de SQL Server. Les modifications apportées à la base de données model (taille, mode de récupération et autres options de base de données) s’appliquent aux bases de données créées par la suite. Cette règle vérifie que dbo est le seul compte autorisé à accéder à la base de données model.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1230     |Filestream doit être désactivé          |Importante         |Filestream intègre le Moteur de base de données SQL Server avec un système de fichiers NTFS en stockant les données d’objet blob varbinary (max) en tant que fichiers dans le système de fichiers. Les instructions Transact-SQL peuvent insérer, mettre à jour, interroger, rechercher et sauvegarder des données Filestream. Lorsque Filestream est activé sur SQL Server, une API de streaming NTFS supplémentaire est exposée, ce qui augmente la surface d’attaque et la rend vulnérable aux attaques malveillantes. Cette règle vérifie que Filestream est désactivé.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1235     |L’option « Replication XPs » de configuration du serveur doit être désactivée          |Medium         |Désactivez la configuration du serveur déconseillée « Replication XPs » pour limiter la surface d’exposition aux attaques. Il s’agit d’un paramètre de configuration interne uniquement.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1244     |Les utilisateurs orphelins doivent être supprimés des bases de données SQL Server          |Moyenne         |Un utilisateurs de base de données qui existe sur une base de données mais qui n’a pas de compte de connexion correspondant dans la base de données master ou en tant que ressource externe (par exemple, un utilisateur Windows) est appelé utilisateur orphelin et doit être supprimé ou remappé sur une connexion valide. Cette règle vérifie qu’il n’y a pas d’utilisateur orphelin.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1245     |Les informations relatives au dbo présentes dans les bases de données cible et master doivent être cohérentes          |Élevé         |Il existe des informations redondantes sur l’identité du dbo pour toute base de données : les métadonnées stockées dans la base de données elle-même et celles stockées dans la base de données master. Cette règle vérifie que les informations présentes dans les bases de données cible et master sont cohérentes.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1247     |Aucune procédure stockée ne doit être marquée en démarrage automatique          |Élevé         |Lorsque SQL Server est configuré pour « rechercher les procédures de démarrage », le serveur recherche dans la base de données master les procédures stockées marquées en démarrage automatique. Cette règle vérifie qu’aucune procédure stockée n’est marquée en démarrage automatique.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1256     |Les assemblies CLR ne doivent pas être définis dans la base de données          |Élevé         |Les assemblies CLR peuvent être utilisés pour exécuter du code de manière arbitraire sur des processus SQL Server. Cette règle vérifie qu’il n’y a pas d’assembly CLR défini par l’utilisateur dans la base de données.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA1277     |Le chiffrement réseau Polybase doit être activé          |Élevé         |PolyBase est une technologie qui accède aux données aussi bien relationnelles que non relationnelles et les combine dans SQL Server. L’option de chiffrement réseau Polybase configure SQL Server pour chiffrer les canaux de contrôle et de données lors de l’utilisation de Polybase. Cette règle vérifie que cette option est activée.         |<nobr>SQL Server 2016+<nobr/>         |
|VA1278     |Créer une base de référence de fournisseurs de gestion de clés externes          |Moyenne         |La Gestion de clés extensible (EKM) SQL Server permet à des fournisseurs d’EKM/HSM tiers d’enregistrer leurs modules dans SQL Server. Lorsqu’ils sont inscrits, les utilisateurs de SQL Server peuvent utiliser les clés de chiffrement stockées dans les modules EKM. Cette règle affiche la liste des fournisseurs EKM utilisés dans le système.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA2062     |Les règles de pare-feu au niveau de la base de données ne doivent pas accorder un accès excessif          |Élevé         |Le pare-feu au niveau d’Azure SQL Database vous aide à protéger vos données en empêchant tout accès à votre base de données tant que vous n’avez pas spécifié les adresses IP autorisées. Les règles de pare-feu au niveau de la base de données octroient l’accès à la base de données spécifique en fonction de l’adresse IP d’origine de chaque requête. Les règles de pare-feu au niveau de la base de données pour les bases de données master et utilisateur peuvent uniquement être créées et gérées via Transact-SQL (à la différence des règles de pare-feu au niveau du serveur, qui peuvent également être créées et gérées dans le portail Azure ou avec PowerShell). Pour plus d’informations, consultez [Règles de pare-feu IP Azure SQL Database et Azure Synapse Analytics](./firewall-configure.md). Ce contrôle vérifie que les règles de pare-feu au niveau de la base de données n’accordent pas d’accès à plus de 255 adresses IP.         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2063     |Les règles de pare-feu au niveau du serveur ne doivent pas accorder un accès excessif          |Élevé         |Le pare-feu au niveau du serveur Azure SQL vous aide à protéger votre serveur en empêchant tout accès à vos bases de données tant que vous n’avez pas spécifié les adresses IP autorisées. Les règles de pare-feu au niveau du serveur octroient l’accès à toutes les bases de données appartenant au serveur en fonction de l’adresse IP d’origine de chaque requête.  Les règles de pare-feu au niveau du serveur peuvent être créées et gérées par le biais de Transact-SQL, ainsi que par le portail Azure ou avec PowerShell. Pour plus d’informations, consultez [Règles de pare-feu IP Azure SQL Database et Azure Synapse Analytics](./firewall-configure.md). Ce contrôle vérifie que les règles de pare-feu au niveau du serveur n’accordent pas d’accès à plus de 255 adresses IP.         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2064     |Les règles de pare-feu au niveau de la base de données doivent être suivies et gérées au strict minimum          |Élevé         |Le pare-feu au niveau d’Azure SQL Database vous aide à protéger vos données en empêchant tout accès à votre base de données tant que vous n’avez pas spécifié les adresses IP autorisées. Les règles de pare-feu au niveau de la base de données octroient l’accès à la base de données spécifique en fonction de l’adresse IP d’origine de chaque requête. Les règles de pare-feu au niveau de la base de données pour les bases de données master et utilisateur peuvent uniquement être créées et gérées via Transact-SQL (à la différence des règles de pare-feu au niveau du serveur, qui peuvent également être créées et gérées dans le portail Azure ou avec PowerShell). Pour plus d’informations, consultez [Règles de pare-feu IP Azure SQL Database et Azure Synapse Analytics](./firewall-configure.md). Ce contrôle énumère toutes les règles de pare-feu au niveau de la base de données pour permettre d’identifier et de traiter les éventuelles modifications apportées.         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2065     |Les règles de pare-feu au niveau du serveur doivent être suivies et gérées au strict minimum          |Élevé         |Le pare-feu au niveau du serveur Azure SQL vous aide à protéger vos données en empêchant tout accès à vos bases de données tant que vous n’avez pas spécifié les adresses IP autorisées. Les règles de pare-feu au niveau du serveur octroient l’accès à toutes les bases de données appartenant au serveur en fonction de l’adresse IP d’origine de chaque requête.  Les règles de pare-feu au niveau du serveur peuvent être créées et gérées par le biais de Transact-SQL, ainsi que par le portail Azure ou avec PowerShell. Pour plus d’informations, consultez [Règles de pare-feu IP Azure SQL Database et Azure Synapse Analytics](./firewall-configure.md).  Ce contrôle énumère toutes les règles de pare-feu au niveau du serveur pour permettre d’identifier et de traiter les éventuelles modifications apportées.         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2111     |Les exemples de bases de données doivent être supprimés          |Faible         |Microsoft SQL Server est fourni avec plusieurs exemples de bases de données. Cette règle vérifie si les exemples de bases de données ont été supprimés.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA2120     |Les fonctionnalités susceptibles d’affecter la sécurité doivent être désactivées          |Élevé         |SQL Server peut fournir un large éventail de fonctionnalités et services. Parmi les fonctionnalités et services fournis par défaut, certains peuvent être inutiles et le fait de les activer peut nuire à la sécurité du système. Cette règle vérifie que ces fonctionnalités sont désactivées.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA2121     | La fonctionnalité « OLE Automation Procedures » doit être désactivée         |Élevé         |SQL Server peut fournir un large éventail de fonctionnalités et services. Parmi les fonctionnalités et services fournis par défaut, certains peuvent être inutiles et le fait de les activer peut nuire à la sécurité du système. L’option OLE Automation Procedures vérifie que les objets OLE Automation peuvent être instanciés dans des lots Transact-SQL. Il s’agit de procédures stockées étendues qui permettent aux utilisateurs de SQL Server d’exécuter des fonctions externes à SQL Server. Indépendamment de ses avantages, cette option peut également être utilisée pour des exploits. Il s’agit d’un mécanisme bien connu pour infiltrer des fichiers sur les ordinateurs cibles. Il est recommandé d’utiliser PowerShell pour remplacer cet outil. Cette règle vérifie que la fonctionnalité « OLE Automation Procedures » est désactivée.          |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA2122     |La fonctionnalité « User Options » doit être désactivée          |Moyenne         |SQL Server peut fournir un large éventail de fonctionnalités et services. Parmi les fonctionnalités et services fournis par défaut, certains peuvent être inutiles et le fait de les activer peut nuire à la sécurité du système. La fonctionnalité User options spécifie des valeurs par défaut globales pour tous les utilisateurs. Une liste d'options de traitement des requêtes par défaut est générée pour la durée d'une session de travail d'un utilisateur. La fonctionnalité User options permet de modifier les valeurs par défaut des options SET (si les paramètres par défaut du serveur ne sont pas appropriés). Cette règle vérifie que la fonctionnalité « User options » est désactivée.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instance managée SQL         |
|VA2126     |Les fonctionnalités d’extensibilité susceptibles d’affecter la sécurité doivent être désactivées si elles ne sont pas nécessaires          |Medium         |SQL Server offre un large éventail de fonctionnalités et de services. Parmi les fonctionnalités et services fournis par défaut, certains peuvent être inutiles et le fait de les activer peut nuire à la sécurité du système. Cette règle vérifie que les configurations qui permettent l’extraction de données vers une source de données externe et l’exécution de scripts avec certaines extensions de langages distantes sont désactivées.         |<nobr>SQL Server 2016+<nobr/>         |

## <a name="removed-rules"></a>Règles supprimées

|Identificateur de la règle  |Titre de la règle  |
|---------|---------|
|VA1021     |Les procédures stockées temporaires globales doivent être supprimées         |
|VA1024    |Le mode audit C2 doit être activé |
|VA1069     |Les autorisations à sélectionner dans des tables et des vues système doivent être révoquées pour les non-administrateurs système         |
|VA1090    |Garantir que toutes les procédures stockées GOTS (Government Off The Shelf) et personnalisées sont chiffrées |
|VA1103    |Utiliser uniquement CLR avec l’autorisation SAFE_ACCESS |
|VA1229     |Le paramètre Filestream doit être identique dans le registre et dans la configuration de SQL Server         |
|VA1231     |Filestream doit être désactivé (SQL)         |
|VA1234     |Le paramètre Critères communs doit être activé         |
|VA1252     |Liste des événements audités et gérés de manière centralisée via les spécifications de l’audit de serveur.         |
|VA1253     |Liste des événements dans l’étendue de la base de données audités et gérés de manière centralisée via les spécifications de l’audit de serveur         |
|VA1263     |Répertorier tous les audits actifs dans le système         |
|VA1266     |L’option « MUST_CHANGE » doit être définie sur toutes les connexions SQL         |
|VA1276     |La fonctionnalité Agent XPs doit être désactivée         |
|VA1286     |Les autorisations de base de données ne doivent pas être accordées directement aux principaux (OBJECT et COLUMN)         |
|VA2000     |Un ensemble minimal de principaux doit recevoir des autorisations limitées à la base de données à impact élevé         |
|VA2001     |Un ensemble minimal de principaux doit recevoir des autorisations limitées à la base de données à impact élevé sur les objets et les colonnes         |
|VA2002     |Un ensemble minimal de principaux doit recevoir des autorisations limitées à la base de données à impact élevé sur différents éléments sécurisables         |
|VA2010     |Un ensemble minimal de principaux doit recevoir des autorisations limitées à la base de données à impact moyen         |
|VA2021     |Un ensemble minimal de principaux doit recevoir des autorisations ALTER limitées à la base de données sur les objets et les colonnes         |
|VA2022     |Un ensemble minimal de principaux doit recevoir des autorisations ALTER limitées à la base de données sur différents éléments sécurisables         |
|VA2030     |Un ensemble minimal de principaux doit recevoir des autorisations SELECT ou EXECUTE limitées à la base de données         |
|VA2031     |Un ensemble minimal de principaux doit recevoir des autorisations SELECT limitées à la base de données          |
|VA2032     |Un ensemble minimal de principaux doit recevoir des autorisations SELECT ou EXECUTE limitées à la base de données sur le schéma         |
|VA2034     |Un ensemble minimal de principaux doit recevoir des autorisations EXECUTE limitées à la base de données sur la collection de schémas XML         |
|VA2040     |Un ensemble minimal de principaux doit recevoir des autorisations limitées à la base de données à impact faible         |
|VA2041     |Un ensemble minimal de principaux doit recevoir des autorisations limitées à la base de données à impact faible sur les objets et les colonnes         |
|VA2042     |Un ensemble minimal de principaux doit recevoir des autorisations limitées à la base de données à impact faible sur le schéma         |
|VA2050     |Un ensemble minimal de principaux doit recevoir des autorisations VIEW DEFINITION limitées à la base de données         |
|VA2051     |Un ensemble minimal de principaux doit recevoir des autorisations VIEW DEFINITION limitées à la base de données sur les objets et les colonnes         |
|VA2052     |Un ensemble minimal de principaux doit recevoir des autorisations VIEW DEFINITION limitées à la base de données sur différents éléments sécurisables         |
|VA2100     |Un ensemble minimal de principaux doit recevoir des autorisations limitées au serveur à impact élevé         |
|VA2101     |Un ensemble minimal de principaux doit recevoir des autorisations limitées au serveur à impact moyen         |
|VA2102     |Un ensemble minimal de principaux doit recevoir des autorisations limitées au serveur à impact faible         |
|VA2104     |Les autorisations d’exécution sur les procédures stockées étendues doivent être révoquées pour le rôle PUBLIC         |
|VA2105     |Le mot de passe de connexion ne doit pas être facile à deviner         |
|VA2112     |Les autorisations du rôle PUBLIC pour DTS (Data Transformation Services) doivent être révoquées         |
|VA2115     |Un ensemble minimal de principaux doivent être membres de rôles de serveur fixes à impact moyen         |
|VA2123     |La fonctionnalité « Remote Access » doit être désactivée         |
|VA2127     |La fonctionnalité « External Scripts » doit être désactivée         |

## <a name="next-steps"></a>Étapes suivantes

- [Évaluation des vulnérabilités](sql-vulnerability-assessment.md)
- [Journal des modifications des règles d’évaluation des vulnérabilités SQL](sql-database-vulnerability-assessment-rules-changelog.md)
