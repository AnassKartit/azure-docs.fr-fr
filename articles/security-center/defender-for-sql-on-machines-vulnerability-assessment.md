---
title: Utilisation de l’analyseur intégré d’évaluation des vulnérabilités pour serveurs SQL de Microsoft Defender pour le cloud
description: Découvrez l’analyseur intégré d’évaluation des vulnérabilités de Microsoft Defender pour les serveurs SQL sur machines
author: memildin
ms.author: memildin
manager: rkarlin
ms.service: security-center
ms.topic: how-to
ms.date: 09/14/2021
ms.openlocfilehash: 6886cb80133dd3b8df6b3c4dbb36123217f3289f
ms.sourcegitcommit: 702df701fff4ec6cc39134aa607d023c766adec3
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/03/2021
ms.locfileid: "131422460"
---
# <a name="scan-your-sql-servers-for-vulnerabilities"></a>Analyser vos serveurs SQL Server à la recherche de vulnérabilités

[!INCLUDE [Banner for top of topics](./includes/banner.md)]

**Microsoft Defender pour les serveurs SQL Server sur les machines** étend les protections de vos serveurs SQL Azure natifs pour prendre en charge les environnements hybrides et protéger les serveurs SQL (toutes les versions prises en charge) hébergés dans Azure, d’autres environnements cloud et même les machines locales :

- [SQL Server sur les machines virtuelles](https://azure.microsoft.com/services/virtual-machines/sql-server/)
- Serveurs SQL locaux :
  - [SQL Server avec Azure Arc (préversion)](/sql/sql-server/azure-arc/overview)
  - [SQL Server exécuté sur des machines Windows sans Azure Arc](../azure-monitor/agents/agent-windows.md)

Le [scanneur d’évaluation des vulnérabilités](../azure-sql/database/sql-vulnerability-assessment.md) intégré découvre et suit les vulnérabilités de base de données potentielles, et vous aide à les corriger. Les résultats des analyses d’évaluation fournissent une vue d’ensemble de l’état de sécurité de vos machines SQL, ainsi que des détails sur les résultats en matière de sécurité.

> [!NOTE]
> L’analyse est légère, sûre et ne prend que quelques secondes par base de données et elle est entièrement en lecture seule. Elle n’apporte aucune modification à la base de données. 

## <a name="explore-vulnerability-assessment-reports"></a>Explorer les rapports d’évaluation des vulnérabilités

Le service d’évaluation des vulnérabilités analyse vos bases de données toutes les 12 heures.

Le tableau de bord d’évaluation des vulnérabilités fournit une vue d’ensemble des résultats de votre évaluation dans toutes vos bases de données, ainsi qu’un résumé des bases de données intègres et non intègres, et un résumé global des vérifications ayant échoué en fonction de la distribution des risques.

Vous pouvez consulter les résultats de l’évaluation des vulnérabilités directement à partir de Defender pour le cloud.

1. Dans la barre latérale de Defender pour le cloud, ouvrez la page **Recommandations**.

1. Sélectionnez la recommandation **Les résultats de l’évaluation des vulnérabilités de vos serveurs SQL sur des machines doivent être corrigés (préversion)** . Pour plus d’informations, consultez la [page de référence des recommandations de Defender pour le cloud](review-security-recommendations.md). 

    :::image type="content" source="./media/security-center-advanced-iaas-data/data-and-storage-sqldb-vulns-on-vm.png" alt-text="Les résultats de l’évaluation des vulnérabilités de vos serveurs SQL sur des machines doivent être corrigés (préversion)":::

    L’affichage détaillé de cette recommandation s’affiche.

    :::image type="content" source="./media/defender-for-sql-on-machines-vulnerability-assessment/sql-vulnerability-findings.png" alt-text="Vue détaillée de la recommandation.":::

1. À explorer pour plus de détails :

    - Pour obtenir une vue d’ensemble des ressources analysées (bases de données) ainsi que la liste des vérifications de sécurité qui ont été testées, ouvrez les **ressources affectées**, puis sélectionnez le serveur qui vous intéresse.

    - Pour obtenir une vue d’ensemble des vulnérabilités regroupées en fonction d’une base de données SQL spécifique, sélectionnez la base de données de votre choix.

    Dans chaque affichage, les vérifications de sécurité sont triées par **Gravité**. Sélectionnez une vérification de sécurité spécifique pour afficher un volet d’informations contenant une **Description**, une méthode de **Correction**, ainsi que d’autres informations associées, telles que l’**Impact** ou les **Références**.

## <a name="set-a-baseline"></a>Définir une ligne de base 

Quand vous examinez les résultats de votre évaluation, vous pouvez marquer certains résultats comme base de référence acceptable dans votre environnement. La ligne de base est en somme une personnalisation du signalement des résultats. Les résultats correspondant à la ligne de base seront considérés comme corrects lors des analyses ultérieures. Une fois que vous avez établi votre état de sécurité de base, l’analyseur d’évaluation des vulnérabilités signale uniquement les écarts par rapport à la ligne de base. Ainsi, vous pouvez vous concentrer sur les problèmes pertinents.

:::image type="content" source="media/defender-for-sql-on-machines-vulnerability-assessment/analyze-report-for-details.png" alt-text="Quand vous examinez les résultats de votre évaluation, vous pouvez marquer certains résultats comme base de référence acceptable dans votre environnement.":::

## <a name="export-results"></a>Exporter les résultats

Utilisez la fonctionnalité [Exportation continue](continuous-export.md) de Microsoft Defender pour le cloud pour exporter les résultats de l’évaluation des vulnérabilités vers Azure Event Hub ou un espace de travail Log Analytics. 

## <a name="view-vulnerabilities-in-graphical-interactive-reports"></a>Afficher les vulnérabilités dans des rapports graphiques interactifs

La galerie intégrée Classeurs Azure Monitor de Defender pour le cloud inclut un rapport interactif de toutes les résultats des scanneurs de vulnérabilités pour les machines, les conteneurs dans les registres de conteneurs et les serveurs SQL Server.

Les résultats de chacun de ces scanneurs sont rapportés dans des recommandations séparées :

- Les vulnérabilités de vos machines virtuelles doivent être corrigées
- Les vulnérabilités dans les images Azure Container Registry doivent être corrigées (avec Qualys)
- Les résultats de l’évaluation des vulnérabilités sur vos bases de données SQL doivent être corrigés
- Les résultats de l’évaluation des vulnérabilités sur vos serveurs SQL sur des machines doivent être corrigés

Le rapport « Résultats de l’évaluation des vulnérabilités » rassemble tous ces résultats et les organise par gravité, type de ressource et catégorie. Le rapport se trouve dans la galerie de classeurs disponible dans la barre latérale de Defender pour le cloud.

:::image type="content" source="media/defender-for-sql-on-machines-vulnerability-assessment/vulnerability-assessment-findings-report-sql.png" alt-text="Rapport des résultats de l’évaluation des vulnérabilités de Defender pour le cloud":::


## <a name="disable-specific-findings-preview"></a>Désactivation de certains résultats (préversion)

Si votre organisation préfère ignorer un résultat, plutôt que de le corriger, vous avez la possibilité de désactiver cette fonction. Les résultats désactivés n’ont pas d’impact sur votre Niveau de sécurité ni ne génèrent de bruit indésirable.

Les résultats correspondant aux critères définis dans vos règles de désactivation n’apparaissent pas dans la liste des résultats. Voici quelques exemples de scénarios courants :

- Désactiver les résultats de gravité inférieure à moyenne
- Désactiver les résultats qui ne peuvent pas être corrigés
- Désactiver les résultats de points de référence ne présentant pas d’intérêt pour une étendue définie

> [!IMPORTANT]
> Pour désactiver des résultats spécifiques, vous devez disposer de l’autorisation de modifier une stratégie dans Azure Policy. Pour plus d’informations, consultez [Autorisations Azure RBAC dans Azure Policy](../governance/policy/overview.md#azure-rbac-permissions-in-azure-policy).

Pour créer une règle :

1. Dans la page de détail des recommandations **Les résultats de l’évaluation des vulnérabilités sur vos serveurs SQL sur des machines doivent être corrigés**, sélectionnez **Désactiver la règle**.

1. Sélectionnez l’étendue nécessaire.

1. Définissez vos critères. Les critères suivants peuvent être utilisés : 
    - ID de résultat 
    - severity 
    - Benchmarks 

    :::image type="content" source="./media/defender-for-sql-on-machines-vulnerability-assessment/disable-rule-vulnerability-findings-sql.png" alt-text="Créer une règle de désactivation pour les résultats de l’évaluation des vulnérabilités sur les serveurs SQL sur des machines.":::

1. Sélectionnez **Appliquer la règle**. Jusqu’à 24 heures peuvent être nécessaires pour que les modifications prennent effet.

1. Pour afficher, remplacer ou supprimer une règle : 

    1. Sélectionnez **Désactiver une règle**.

    1. Dans la liste des étendues, les abonnements présentant des règles actives apparaissent avec la mention **Règle appliquée**.

        :::image type="content" source="./media/remediate-vulnerability-findings-vm/modify-rule.png" alt-text="Modifier ou supprimer une règle existante.":::

    1. Pour afficher ou supprimer la règle, sélectionnez le menu de points de suspension (« … »).

## <a name="manage-vulnerability-assessments-programmatically"></a>Gérer les évaluations de vulnérabilité par programmation

### <a name="using-azure-powershell"></a>Utilisation de Microsoft Azure PowerShell

Vous pouvez utiliser les applets de commande Azure PowerShell pour gérer par programmation l’évaluation des vulnérabilités. Les applets de commande prises en charge sont les suivantes :

| Nom de l’applet de commande sous forme de lien | Description |
| :-------------------- | :---------- |
| [Add-AzSecuritySqlVulnerabilityAssessmentBaseline](/powershell/module/az.security/add-azsecuritysqlvulnerabilityassessmentbaseline) | Ajoute la base de référence de l’évaluation des vulnérabilités SQL. |
| [Get-AzSecuritySqlVulnerabilityAssessmentBaseline](/powershell/module/az.security/get-azsecuritysqlvulnerabilityassessmentbaseline) | Obtient la base de référence de l’évaluation des vulnérabilités SQL. |
| [Get-AzSecuritySqlVulnerabilityAssessmentScanResult](/powershell/module/az.security/get-azsecuritysqlvulnerabilityassessmentscanresult) | Obtient les résultats de l’analyse de l’évaluation des vulnérabilités SQL. |
| [Get-AzSecuritySqlVulnerabilityAssessmentScanRecord](/powershell/module/az.security/get-azsecuritysqlvulnerabilityassessmentscanrecord) | Obtient les enregistrements de l’analyse de l’évaluation des vulnérabilités SQL. |
| [Remove-AzSecuritySqlVulnerabilityAssessmentBaseline](/powershell/module/az.security/remove-azsecuritysqlvulnerabilityassessmentbaseline) | Supprime la ligne de base d’évaluation des vulnérabilités SQL. |
| [Set-AzSecuritySqlVulnerabilityAssessmentBaseline](/powershell/module/az.security/set-azsecuritysqlvulnerabilityassessmentbaseline) | Définit la nouvelle base de référence de l’évaluation des vulnérabilités SQL sur une base de données spécifique, supprime l’ancienne base de référence le cas échéant. |
| &nbsp; | &nbsp; |

## <a name="data-residency"></a>Résidence des données

L’évaluation des vulnérabilités SQL interroge le serveur SQL à l’aide de requêtes disponibles publiquement sous les recommandations de Defender pour le cloud pour l’évaluation des vulnérabilités SQL, et stocke les résultats des requêtes. Les données d’évaluation des vulnérabilités SQL sont stockées à l’emplacement de l’espace de travail Log Analytics auquel la machine est connectée. Par exemple, si l’utilisateur connecte une machine virtuelle SQL à un espace de travail Log Analytics dans la région Europe Ouest, les résultats sont stockés en Europe de l’Ouest. Ces données sont collectées uniquement si la solution d’évaluation des vulnérabilités SQL est activée sur l’espace de travail Log Analytics.

Les informations de métadonnées relatives à la machine connectée sont également collectées. Plus précisément :

-   Nom, type et version du système d’exploitation
-   Nom de domaine complet (FQDN) de l’ordinateur
-   Version de l’agent Machine connectée
-   UUID (ID BIOS)
-   Nom du serveur SQL et noms des bases de données sous-jacentes

L’évaluation des vulnérabilités SQL vous permet de spécifier la région où vos données seront stockées en choisissant l’emplacement de l’espace de travail Log Analytics. Microsoft peut répliquer vers d’autres régions à des fins de résilience des données, mais Microsoft ne réplique pas les données en dehors de la zone géographique.

## <a name="next-steps"></a>Étapes suivantes

Apprenez-en davantage sur les protections de Defender pour le cloud pour les ressources SQL dans [Présentation de Microsoft Defender pour le cloud](defender-for-sql-introduction.md).
