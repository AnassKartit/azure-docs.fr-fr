---
title: 'DÃ©marrage rapideÂ : Form RecognizerÂ v3.0 avec kit SDK C# | PrÃ©version'
titleSuffix: Azure Applied AI Services
description: Traitement, extraction des donnÃ©es et analyse des formulaires et des documents Ã  lâ€™aide de Form Recognizer v3.0 avec les kits SDK de la bibliothÃ¨que de client C# (prÃ©version)
author: laujan
manager: nitinme
ms.service: applied-ai-services
ms.subservice: forms-recognizer
ms.topic: quickstart
ms.date: 10/07/2021
ms.author: lajanuar
recommendations: false
ms.openlocfilehash: 50c1cfbcfc79212f03fd67f783afaff110ce1e09
ms.sourcegitcommit: 692382974e1ac868a2672b67af2d33e593c91d60
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/22/2021
ms.locfileid: "130216729"
---
# <a name="quickstart-form-recognizer-c-client-library-sdks-v30--preview"></a>DÃ©marrage rapideÂ : Form Recognizer v3.0 avec les kits SDK de la bibliothÃ¨que de client C# | PrÃ©version

Bien dÃ©marrer avec Azure Form Recognizer en utilisant le langage de programmationÂ C#. Azure Form Recognizer est un service cloud [Azure Applied AI Services](../../../applied-ai-services/index.yml) qui vous permet de gÃ©nÃ©rer des logiciels de traitement de donnÃ©es automatisÃ©s Ã  lâ€™aide de la technologie du machine learning. Vous pouvez utiliser Form Recognizer via lâ€™API REST ou un kit SDK. Nous vous recommandons dâ€™utiliser le service gratuit pendant que vous apprenez la technologie. Nâ€™oubliez pas que le nombre de pages gratuites est limitÃ© Ã  500 par mois.

>[!NOTE]
> Form RecognizerÂ v3.0 est actuellement en prÃ©version publique. Certaines fonctionnalitÃ©s risquent de ne pas Ãªtre prises en charge ou dâ€™avoir des capacitÃ©s limitÃ©es. 

[Documentation de rÃ©fÃ©rence](/dotnet/api/overview/azure/ai.formrecognizer-readme?view=azure-dotnet&preserve-view=true ) | [Code source de la bibliothÃ¨que](https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/formrecognizer/Azure.AI.FormRecognizer/src) | [Package (NuGet)](https://www.nuget.org/packages/Azure.AI.FormRecognizer) | [Exemples](https://github.com/Azure/azure-sdk-for-net/blob/main/sdk/formrecognizer/Azure.AI.FormRecognizer/samples/README.md)

Azure Cognitive Services Form Recognizer est un service cloud qui utilise le machine learning pour extraire et analyser les champs de formulaire, le texte et les tableaux de vos documents. Vous pouvez facilement appeler des modÃ¨les Form Recognizer en intÃ©grant les kits SDK de notre bibliothÃ¨que de client dans vos workflows et applications.

### <a name="form-recognizer-models"></a>ModÃ¨les Form Recognizer

Le kit SDK C# prend en charge les modÃ¨les et les fonctionnalitÃ©s suivantsÂ :

* ğŸ†•Document gÃ©nÃ©ral â€“ Analysez et extrayez le texte, les tableaux, la structure, les paires clÃ©-valeur et les entitÃ©s nommÃ©es.|
* Disposition â€“ Analysez et extrayez les tableaux, les lignes, les mots et les marques de sÃ©lection telles que les cases dâ€™option et les cases Ã  cocher dans des formulaires, sans avoir besoin dâ€™entraÃ®ner un modÃ¨le.
* PersonnalisÃ© â€“ Analysez et extrayez les champs de formulaire et dâ€™autres contenus de vos formulaires personnalisÃ©s en utilisant des modÃ¨les que vous avez entraÃ®nÃ©s avec vos propres types de formulaires.
* Factures â€“ Analysez et extrayez les champs courants des factures en utilisant un modÃ¨le de facture prÃ©entraÃ®nÃ©.
* ReÃ§us â€“ Analysez et extrayez les champs courants des reÃ§us en utilisant un modÃ¨le de reÃ§u prÃ©entraÃ®nÃ©.
* Documents dâ€™identitÃ© â€“ Analysez et extrayez les champs courants des documents dâ€™identitÃ©, tels que les passeports ou les permis de conduire, en utilisant un modÃ¨le de piÃ¨ce dâ€™identitÃ© prÃ©entraÃ®nÃ©.
* Cartes de visite â€“ Analysez et extrayez les champs courants des cartes de visite en utilisant un modÃ¨le de carte de visite prÃ©entraÃ®nÃ©.

Dans ce guide de dÃ©marrage rapide, vous allez utiliser les fonctionnalitÃ©s suivantes pour analyser et extraire les donnÃ©es et les valeurs de formulaires et de documentsÂ :

* [**Document gÃ©nÃ©ral**](#try-it-general-document-model)

* [**Layout**](#try-it-layout-model)

* [**Facture prÃ©dÃ©finie**](#try-it-prebuilt-invoice-model)

## <a name="prerequisites"></a>PrÃ©requis

* Abonnement AzureÂ - [En crÃ©er un gratuitement](https://azure.microsoft.com/free/cognitive-services/)

* La version actuelle de lâ€™[IDE Visual Studio](https://visualstudio.microsoft.com/vs/) ou [.NET Core](https://dotnet.microsoft.com/download).

* Une ressource Cognitive Services ou Form Recognizer. Une fois que vous avez votre abonnement Azure, crÃ©ez une ressource Form Recognizer [monoservice](https://ms.portal.azure.com/#create/Microsoft.CognitiveServicesFormRecognizer) ou [multiservice](https://ms.portal.azure.com/#create/Microsoft.CognitiveServicesAllInOne) dans le portail Azure pour obtenir votre clÃ© et votre point de terminaison. Vous pouvez utiliser le niveau tarifaire Gratuit (`F0`) pour tester le service, puis passer par la suite Ã  un niveau payant pour la production.

> [!TIP] 
> CrÃ©ez une ressource Cognitive Services si vous envisagez dâ€™accÃ©der Ã  plusieurs services Cognitive Services sous un seul point de terminaison/clÃ©. Pour lâ€™accÃ¨s Ã  Form Recognizer uniquement, crÃ©ez une ressource Form Recognizer. Notez que vous avez besoin dâ€™une ressource monoservice si vous avez lâ€™intention dâ€™utiliser lâ€™[authentification Azure Active Directory](../../../active-directory/authentication/overview-authentication.md).

* Une fois que votre ressource est dÃ©ployÃ©e, cliquez sur **AccÃ©der Ã  la ressource**. Vous avez besoin de la clÃ© et du point de terminaison de la ressource que vous crÃ©ez pour connecter votre application Ã  lâ€™API Form Recognizer. Vous collerez votre clÃ© et votre point de terminaison dans le code ci-dessous plus loin dans ce guide de dÃ©marrage rapideÂ :

  :::image type="content" source="../media/containers/keys-and-endpoint.png" alt-text="Capture dâ€™Ã©cranÂ : clÃ©s et emplacement du point de terminaison dans le portail Azure":::

## <a name="set-up"></a>Configurer

### <a name="option-1-net-command-line-interface-cli"></a>[OptionÂ 1Â : interface de ligne de commande (CLI) .NET](#tab/cli)

Dans une fenÃªtre de console (par exemple cmd, PowerShell ou Bash), utilisez la commande `dotnet new` pour crÃ©er une application console avec le nom `formrecognizer-quickstart`. Cette commande crÃ©e un projet C# Â«Â Hello WorldÂ Â» simple avec un seul fichier sourceÂ : *Program.cs*.

```console
dotnet new console -n formrecognizer-quickstart
```

Ouvrez une ligne de commande et accÃ©dez au rÃ©pertoire contenant votre fichier projet. GÃ©nÃ©rez lâ€™application avecÂ :

```console
dotnet build
```

La sortie de gÃ©nÃ©ration ne doit contenir aucun avertissement ni erreur.

```console
...
Build succeeded.
 0 Warning(s)
 0 Error(s)
...
```

### <a name="install-the-client-library-with-nuget"></a>Installer la bibliothÃ¨que de client avec NuGet

Dans le rÃ©pertoire qui contient votre projet, installez la bibliothÃ¨que de client Form Recognizer pour .NET avec la commande suivanteÂ :

```console
dotnet add package Azure.AI.FormRecognizer
```

Cette version de la bibliothÃ¨que de client correspond par dÃ©faut Ã  la version 2021-09-30-preview du service.

### <a name="option-2-visual-studio"></a>[Option 2 : Visual Studio](#tab/vs)

1. DÃ©marrez Visual StudioÂ 2019.

1. Dans la page de dÃ©marrage, choisissez CrÃ©er un projet.

    :::image type="content" source="../media/quickstarts/start-window.png" alt-text="Capture dâ€™Ã©cranÂ : fenÃªtre de dÃ©marrage Visual Studio":::

1. Dans la page **CrÃ©er un nouveau projet**, entrez **console** dans la zone de recherche. Choisissez le modÃ¨le **Application console**, puis choisissez **Suivant**.

    :::image type="content" source="../media/quickstarts/create-new-project.png" alt-text="Capture dâ€™Ã©cranÂ : page CrÃ©er un nouveau projet dans Visual Studio":::

1. Dans la fenÃªtre de dialogue **Configurer votre nouveau projet**, entrez `formRecognizer_quickstart` dans la zone Nom de projet. Ensuite, choisissez Suivant.

    :::image type="content" source="../media/quickstarts/configure-new-project.png" alt-text="Capture dâ€™Ã©cranÂ : fenÃªtre de dialogue Configurer un nouveau projet dans Visual Studio":::

1. Dans la fenÃªtre de dialogue **Informations supplÃ©mentaires**, sÃ©lectionnez **.NETÂ 5.0 (Actuel)** , puis sÃ©lectionnez **CrÃ©er**.

    :::image type="content" source="../media/quickstarts/additional-information.png" alt-text="Capture dâ€™Ã©cranÂ : fenÃªtre de dialogue Informations supplÃ©mentaires dans Visual Studio":::

### <a name="install-the-client-library-with-nuget"></a>Installer la bibliothÃ¨que de client avec NuGet

 1. Cliquez avec le bouton droit sur votre projet **formRecognizer_quickstart** et sÃ©lectionnez **GÃ©rer les packages NuGet**.

    :::image type="content" source="../media/quickstarts/select-nuget-package.png" alt-text="Capture dâ€™Ã©cranÂ : select-nuget-package.png":::

 1. SÃ©lectionnez lâ€™onglet Parcourir et tapez Azure.AI.FormRecognizer.

     :::image type="content" source="../media/quickstarts/azure-nuget-package.png" alt-text="Capture dâ€™Ã©cranÂ : select-form-recognizer-package.png":::

 1. SÃ©lectionnez la version souhaitÃ©e dans le menu dÃ©roulant et sÃ©lectionnez **Installer**.

     Cette version de la bibliothÃ¨que de client correspond par dÃ©faut Ã  la version 2021-09-30-preview du service.

---

## <a name="build-your-application"></a>GÃ©nÃ©rer votre application

Pour interagir avec le service Form Recognizer, vous devez crÃ©er une instance de la classe `DocumentAnalysisClient`. Pour ce faire, vous allez crÃ©er un `AzureKeyCredential` avec votre apiKey et une instance `DocumentAnalysisClient` avec le `AzureKeyCredential` et votre `endpoint` de Form Recognizer.

1. Ouvrez le fichier **Program.cs**.

1. InsÃ©rez les directives using suivantesÂ :

    ```csharp
    using System;
    using System.Threading.Tasks;
    using Azure.AI.FormRecognizer.DocumentAnalysis;
    ```

1. DÃ©finissez vos variables dâ€™environnement `endpoint` et `apiKey`, et crÃ©ez vos instances `AzureKeyCredential` et `DocumentAnalysisClient`Â :

    ```csharp
    string endpoint = "<your-endpoint>";
    string apiKey = "<your-apiKey>";
    var credential = new AzureKeyCredential(apiKey);
    var client = new DocumentAnalysisClient(new Uri(endpoint), credential);
    ```

1. Supprimez la ligne `Console.Writeline("Hello World!");` et ajoutez le code **Essayez** dans la mÃ©thode **Main** du fichier **Program.cs**Â :

    :::image type="content" source="../media/quickstarts/add-code-here.png" alt-text="Capture dâ€™Ã©cranÂ : ajout de lâ€™exemple de code Ã  la mÃ©thode Main":::

## <a name="try-it-general-document-model"></a>**Essayez**Â : modÃ¨le de document gÃ©nÃ©ral

> [!div class="checklist"]
>
> * Pour cet exemple, vous aurez besoin dâ€™un **fichier de formulaire au niveau dâ€™un URI**. Vous pouvez utiliser notre [exemple de formulaire](https://raw.githubusercontent.com/Azure-Samples/cognitive-services-REST-api-samples/master/curl/form-recognizer/sample-layout.pdf) pour ce guide de dÃ©marrage rapide.
> * Ajoutez la valeur de lâ€™URI du fichier Ã  la variable `string fileUri` en haut de la mÃ©thode Main.
> * Pour analyser un fichier donnÃ© au niveau dâ€™un URI, vous utiliserez la mÃ©thode `StartAnalyzeDocumentFromUri`. La valeur retournÃ©e est un objet `AnalyzeResult` contenant des donnÃ©es relatives au document envoyÃ©.

### <a name="add-the-following-code-to-your-general-document-application-main-method"></a>Ajouter le code suivant Ã  la mÃ©thode **Main** de votre application de document gÃ©nÃ©ral

```csharp
// sample form document
string fileUri = "https://raw.githubusercontent.com/Azure-Samples/cognitive-services-REST-api-samples/master/curl/form-recognizer/sample-layout.pdf";

AnalyzeDocumentOperation operation = await client.StartAnalyzeDocumentFromUriAsync("prebuilt-document", fileUri);

await operation.WaitForCompletionAsync();

AnalyzeResult result = operation.Value;

Console.WriteLine("Detected entities:");

foreach (DocumentEntity entity in result.Entities)
{
    if (entity.SubCategory == null)
    {
        Console.WriteLine($"  Found entity '{entity.Content}' with category '{entity.Category}'.");
    }
    else
    {
        Console.WriteLine($"  Found entity '{entity.Content}' with category '{entity.Category}' and sub-category '{entity.SubCategory}'.");
    }
}

Console.WriteLine("Detected key-value pairs:");

foreach (DocumentKeyValuePair kvp in result.KeyValuePairs)
{
    if (kvp.Value.Content == null)
    {
        Console.WriteLine($"  Found key with no value: '{kvp.Key.Content}'");
    }
    else
    {
        Console.WriteLine($"  Found key-value pair: '{kvp.Key.Content}' and '{kvp.Value.Content}'");
    }
}

foreach (DocumentPage page in result.Pages)
{
    Console.WriteLine($"Document Page {page.PageNumber} has {page.Lines.Count} line(s), {page.Words.Count} word(s),");
    Console.WriteLine($"and {page.SelectionMarks.Count} selection mark(s).");

    for (int i = 0; i < page.Lines.Count; i++)
    {
        DocumentLine line = page.Lines[i];
        Console.WriteLine($"  Line {i} has content: '{line.Content}'.");

        Console.WriteLine($"    Its bounding box is:");
        Console.WriteLine($"      Upper left => X: {line.BoundingBox[0].X}, Y= {line.BoundingBox[0].Y}");
        Console.WriteLine($"      Upper right => X: {line.BoundingBox[1].X}, Y= {line.BoundingBox[1].Y}");
        Console.WriteLine($"      Lower right => X: {line.BoundingBox[2].X}, Y= {line.BoundingBox[2].Y}");
        Console.WriteLine($"      Lower left => X: {line.BoundingBox[3].X}, Y= {line.BoundingBox[3].Y}");
    }

    for (int i = 0; i < page.SelectionMarks.Count; i++)
    {
        DocumentSelectionMark selectionMark = page.SelectionMarks[i];

        Console.WriteLine($"  Selection Mark {i} is {selectionMark.State}.");
        Console.WriteLine($"    Its bounding box is:");
        Console.WriteLine($"      Upper left => X: {selectionMark.BoundingBox[0].X}, Y= {selectionMark.BoundingBox[0].Y}");
        Console.WriteLine($"      Upper right => X: {selectionMark.BoundingBox[1].X}, Y= {selectionMark.BoundingBox[1].Y}");
        Console.WriteLine($"      Lower right => X: {selectionMark.BoundingBox[2].X}, Y= {selectionMark.BoundingBox[2].Y}");
        Console.WriteLine($"      Lower left => X: {selectionMark.BoundingBox[3].X}, Y= {selectionMark.BoundingBox[3].Y}");
    }
}

foreach (DocumentStyle style in result.Styles)
{
    // Check the style and style confidence to see if text is handwritten.
    // Note that value '0.8' is used as an example.

    bool isHandwritten = style.IsHandwritten.HasValue && style.IsHandwritten == true;

    if (isHandwritten && style.Confidence > 0.8)
    {
        Console.WriteLine($"Handwritten content found:");

        foreach (DocumentSpan span in style.Spans)
        {
            Console.WriteLine($"  Content: {result.Content.Substring(span.Offset, span.Length)}");
        }
    }
}

Console.WriteLine("The following tables were extracted:");

for (int i = 0; i < result.Tables.Count; i++)
{
    DocumentTable table = result.Tables[i];
    Console.WriteLine($"  Table {i} has {table.RowCount} rows and {table.ColumnCount} columns.");

    foreach (DocumentTableCell cell in table.Cells)
    {
        Console.WriteLine($"    Cell ({cell.RowIndex}, {cell.ColumnIndex}) has kind '{cell.Kind}' and content: '{cell.Content}'.");
    }
}

```

## <a name="try-it-layout-model"></a>**Essayez**Â : modÃ¨le de disposition

Extrayez le texte, les marques de sÃ©lection, les styles de texte et les structures de tableaux, ainsi que les coordonnÃ©es de leurs cadres de limitation, Ã  partir de documents.

> [!div class="checklist"]
>
> * Pour cet exemple, vous aurez besoin dâ€™un **fichier de formulaire au niveau dâ€™un URI**. Vous pouvez utiliser notre [exemple de formulaire](https://raw.githubusercontent.com/Azure-Samples/cognitive-services-REST-api-samples/master/curl/form-recognizer/sample-layout.pdf) pour ce guide de dÃ©marrage rapide.
> * Ajoutez la valeur de lâ€™URI du fichier Ã  la variable `string fileUri` en haut de la mÃ©thode Main.
> * Pour extraire la disposition dâ€™un fichier donnÃ© au niveau dâ€™un URI, utilisez la mÃ©thode `StartAnalyzeDocumentFromUri` et transmettez `prebuilt-layout` comme ID de modÃ¨le. La valeur retournÃ©e est un objet `AnalyzeResult` contenant des donnÃ©es provenant du document envoyÃ©.

### <a name="add-the-following-code-to-your-layout-application-main-method"></a>Ajouter le code suivant Ã  la mÃ©thode **Main** de votre application de disposition

```csharp
// sample form document
string fileUri = "https://raw.githubusercontent.com/Azure-Samples/cognitive-services-REST-api-samples/master/curl/form-recognizer/sample-layout.pdf";

AnalyzeDocumentOperation operation = await client.StartAnalyzeDocumentFromUriAsync("prebuilt-layout", fileUri);

await operation.WaitForCompletionAsync();

AnalyzeResult result = operation.Value;

foreach (DocumentPage page in result.Pages)
{
    Console.WriteLine($"Document Page {page.PageNumber} has {page.Lines.Count} line(s), {page.Words.Count} word(s),");
    Console.WriteLine($"and {page.SelectionMarks.Count} selection mark(s).");

    for (int i = 0; i < page.Lines.Count; i++)
    {
        DocumentLine line = page.Lines[i];
        Console.WriteLine($"  Line {i} has content: '{line.Content}'.");

        Console.WriteLine($"    Its bounding box is:");
        Console.WriteLine($"      Upper left => X: {line.BoundingBox[0].X}, Y= {line.BoundingBox[0].Y}");
        Console.WriteLine($"      Upper right => X: {line.BoundingBox[1].X}, Y= {line.BoundingBox[1].Y}");
        Console.WriteLine($"      Lower right => X: {line.BoundingBox[2].X}, Y= {line.BoundingBox[2].Y}");
        Console.WriteLine($"      Lower left => X: {line.BoundingBox[3].X}, Y= {line.BoundingBox[3].Y}");
    }

    for (int i = 0; i < page.SelectionMarks.Count; i++)
    {
        DocumentSelectionMark selectionMark = page.SelectionMarks[i];

        Console.WriteLine($"  Selection Mark {i} is {selectionMark.State}.");
        Console.WriteLine($"    Its bounding box is:");
        Console.WriteLine($"      Upper left => X: {selectionMark.BoundingBox[0].X}, Y= {selectionMark.BoundingBox[0].Y}");
        Console.WriteLine($"      Upper right => X: {selectionMark.BoundingBox[1].X}, Y= {selectionMark.BoundingBox[1].Y}");
        Console.WriteLine($"      Lower right => X: {selectionMark.BoundingBox[2].X}, Y= {selectionMark.BoundingBox[2].Y}");
        Console.WriteLine($"      Lower left => X: {selectionMark.BoundingBox[3].X}, Y= {selectionMark.BoundingBox[3].Y}");
    }
}

foreach (DocumentStyle style in result.Styles)
{
    // Check the style and style confidence to see if text is handwritten.
    // Note that value '0.8' is used as an example.

    bool isHandwritten = style.IsHandwritten.HasValue && style.IsHandwritten == true;

    if (isHandwritten && style.Confidence > 0.8)
    {
        Console.WriteLine($"Handwritten content found:");

        foreach (DocumentSpan span in style.Spans)
        {
            Console.WriteLine($"  Content: {result.Content.Substring(span.Offset, span.Length)}");
        }
    }
}

Console.WriteLine("The following tables were extracted:");

for (int i = 0; i < result.Tables.Count; i++)
{
    DocumentTable table = result.Tables[i];
    Console.WriteLine($"  Table {i} has {table.RowCount} rows and {table.ColumnCount} columns.");

    foreach (DocumentTableCell cell in table.Cells)
    {
        Console.WriteLine($"    Cell ({cell.RowIndex}, {cell.ColumnIndex}) has kind '{cell.Kind}' and content: '{cell.Content}'.");
    }
}

```

## <a name="try-it-prebuilt-invoice-model"></a>**Essayez**Â : modÃ¨le de facture prÃ©dÃ©finie

Cet exemple montre comment analyser les donnÃ©es de certains types de documents courants avec des modÃ¨les prÃ©entraÃ®nÃ©s, Ã  lâ€™aide dâ€™une facture Ã  titre dâ€™exemple.

> [!div class="checklist"]
>
> * Pour cet exemple, vous aurez besoin dâ€™un **fichier de facture au niveau dâ€™un URI**. Vous pouvez utiliser notre [exemple de facture](https://raw.githubusercontent.com/Azure-Samples/cognitive-services-REST-api-samples/master/curl/form-recognizer/sample-invoice.pdf) pour ce guide de dÃ©marrage rapide.
> * Ajoutez la valeur de lâ€™URI du fichier Ã  la variable `string fileUri` en haut de la mÃ©thode Main.
> * Pour analyser un fichier donnÃ© au niveau dâ€™un URI, utilisez la mÃ©thode `StartAnalyzeDocumentFromUri` et transmettez-lui `prebuilt-invoice` comme ID de modÃ¨le. La valeur retournÃ©e est un objet `AnalyzeResult` contenant des donnÃ©es provenant du document envoyÃ©.

### <a name="choose-the-invoice-prebuilt-model-id"></a>Choisir lâ€™ID de modÃ¨le de facture prÃ©dÃ©finie

Vous nâ€™Ãªtes pas limitÃ© aux factures â€“ Vous avez le choix entre plusieurs modÃ¨les prÃ©dÃ©finis, chacun ayant son propre ensemble de champs pris en charge. Le modÃ¨le Ã  utiliser pour lâ€™opÃ©ration dâ€™analyse dÃ©pend du type de document Ã  analyser. Voici les ID de modÃ¨le pour les modÃ¨les prÃ©dÃ©finis actuellement pris en charge par le service Form RecognizerÂ :

* **prebuilt-invoice**Â : extrait le texte, les marques de sÃ©lection, les tableaux, les paires clÃ©-valeur et les informations clÃ©s des factures.
* **prebuilt-businessCard**Â : extrait le texte et les informations clÃ©s des cartes de visite.
* **prebuilt-idDocument**Â : extrait le texte et les informations clÃ©s des permis de conduire et des passeports internationaux.
* **prebuilt-receipt**Â : extrait le texte et les informations clÃ©s des reÃ§us.

### <a name="add-the-following-code-to-your-prebuilt-invoice-application-main-method"></a>Ajouter le code suivant Ã  la mÃ©thode **Main** de votre application de facture prÃ©dÃ©finie

```csharp
// sample invoice document
string filePath = "(https://raw.githubusercontent.com/Azure-Samples/cognitive-services-REST-api-samples/master/curl/form-recognizer/sample-invoice.pdf";

using var stream = new FileStream(filePath, FileMode.Open);

AnalyzeDocumentOperation operation = await client.StartAnalyzeDocumentAsync("prebuilt-invoice", stream);

await operation.WaitForCompletionAsync();

AnalyzeResult result = operation.Value;

for (int i = 0; i < result.Documents.Count; i++)
{
    Console.WriteLine($"Document {i}:");

    AnalyzedDocument document = result.Documents[i];

    if (document.Fields.TryGetValue("VendorName", out DocumentField vendorNameField))
    {
        if (vendorNameField.ValueType == DocumentFieldType.String)
        {
            string vendorName = vendorNameField.AsString();
            Console.WriteLine($"Vendor Name: '{vendorName}', with confidence {vendorNameField.Confidence}");
        }
    }

    if (document.Fields.TryGetValue("CustomerName", out DocumentField customerNameField))
    {
        if (customerNameField.ValueType == DocumentFieldType.String)
        {
            string customerName = customerNameField.AsString();
            Console.WriteLine($"Customer Name: '{customerName}', with confidence {customerNameField.Confidence}");
        }
    }

    if (document.Fields.TryGetValue("Items", out DocumentField itemsField))
    {
        if (itemsField.ValueType == DocumentFieldType.List)
        {
            foreach (DocumentField itemField in itemsField.AsList())
            {
                Console.WriteLine("Item:");

                if (itemField.ValueType == DocumentFieldType.Dictionary)
                {
                    IReadOnlyDictionary<string, DocumentField> itemFields = itemField.AsDictionary();

                    if (itemFields.TryGetValue("Description", out DocumentField itemDescriptionField))
                    {
                        if (itemDescriptionField.ValueType == DocumentFieldType.String)
                        {
                            string itemDescription = itemDescriptionField.AsString();

                            Console.WriteLine($"  Description: '{itemDescription}', with confidence {itemDescriptionField.Confidence}");
                        }
                    }

                    if (itemFields.TryGetValue("Amount", out DocumentField itemAmountField))
                    {
                        if (itemAmountField.ValueType == DocumentFieldType.Double)
                        {
                            double itemAmount = itemAmountField.AsDouble();

                            Console.WriteLine($"  Amount: '{itemAmount}', with confidence {itemAmountField.Confidence}");
                        }
                    }
                }
            }
        }
    }

    if (document.Fields.TryGetValue("SubTotal", out DocumentField subTotalField))
    {
        if (subTotalField.ValueType == DocumentFieldType.Double)
        {
            double subTotal = subTotalField.AsDouble();
            Console.WriteLine($"Sub Total: '{subTotal}', with confidence {subTotalField.Confidence}");
        }
    }

    if (document.Fields.TryGetValue("TotalTax", out DocumentField totalTaxField))
    {
        if (totalTaxField.ValueType == DocumentFieldType.Double)
        {
            double totalTax = totalTaxField.AsDouble();
            Console.WriteLine($"Total Tax: '{totalTax}', with confidence {totalTaxField.Confidence}");
        }
    }

    if (document.Fields.TryGetValue("InvoiceTotal", out DocumentField invoiceTotalField))
    {
        if (invoiceTotalField.ValueType == DocumentFieldType.Double)
        {
            double invoiceTotal = invoiceTotalField.AsDouble();
            Console.WriteLine($"Invoice Total: '{invoiceTotal}', with confidence {invoiceTotalField.Confidence}");
        }
    }
}

```

## <a name="run-your-application"></a>ExÃ©cuter votre application

### <a name="net-command-line-interface-cli"></a>[Interface de ligne de commande (CLI) .NET](#tab/cli)

Ouvrez votre invite de commandes et accÃ©dez au rÃ©pertoire qui contient votre projet, et tapez ce qui suitÂ :

```console
dotnet run formrecognizer-quickstart.dll
```

### <a name="visual-studio"></a>[VisualÂ Studio](#tab/vs)

Choisissez le bouton vert **DÃ©marrer** en regard de formRecognizer_quickstart pour gÃ©nÃ©rer et exÃ©cuter votre programme, ou appuyez sur **F5**.

  :::image type="content" source="../media/quickstarts/run-visual-studio.png" alt-text="Capture dâ€™Ã©cranÂ : exÃ©cutez votre programme Visual Studio":::

---

FÃ©licitations ! Dans ce guide de dÃ©marrage rapide, vous avez utilisÃ© Form Recognizer avec le kit SDK C# pour analyser divers formulaires et documents de diffÃ©rentes maniÃ¨res. Explorez Ã  prÃ©sent la documentation de rÃ©fÃ©rence pour dÃ©couvrir plus en dÃ©tail lâ€™API Form Recognizer.

## <a name="next-steps"></a>Ã‰tapes suivantes

> [!div class="nextstepaction"]
> [Documentation de rÃ©fÃ©rence de lâ€™API REST v3.0](https://westus.dev.cognitive.microsoft.com/docs/services/form-recognizer-api-v3-0-preview-1/operations/AnalyzeDocument)